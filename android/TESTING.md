# Тестирование Android приложения

## Шаг 1: Подключение устройства

### На телефоне Xiaomi K60 Ultra:

1. **Включите режим разработчика:**
   - Откройте **Настройки → О телефоне**
   - Нажмите 7 раз на **Номер сборки** (или **Версия MIUI**)
   - Появится сообщение "Вы стали разработчиком"

2. **Включите отладку:**
   - Вернитесь в **Настройки → Дополнительные настройки → Для разработчиков**
   - Включите **Отладка по USB**
   - Включите **Установка через USB** (если есть)
   - Включите **Отладка USB** (если есть)

3. **Подключите телефон:**
   - Подключите телефон к компьютеру через USB кабель
   - На телефоне может появиться запрос "Разрешить отладку по USB?" - нажмите **Разрешить**
   - Отметьте "Всегда разрешать с этого компьютера" (если хотите)

## Шаг 2: Проверка подключения в Qt Creator

1. **В Qt Creator:**
   - Перейдите в **Tools → Options → Devices → Android**
   - Нажмите **Test** - должно появиться сообщение об успешном подключении

2. **Или через ADB (командная строка):**
   ```bash
   adb devices
   ```
   Должно показать ваше устройство, например:
   ```
   List of devices attached
   abc123def456    device
   ```

## Шаг 3: Запуск приложения

### Вариант A: Через Qt Creator (рекомендуется)

1. **В Qt Creator:**
   - Убедитесь, что выбран Kit "Android arm64-v8a (Qt 5.15.2)"
   - Перейдите в **Projects → Run Settings**
   - В разделе "Run" выберите:
     - **Package name**: `com.voiceupsidedown.master`
     - **Application binary**: `voice_upside_down`
     - **Target device**: выберите ваше устройство (Xiaomi K60 Ultra)

2. **Запустите приложение:**
   - Нажмите зеленую кнопку **Run** (▶) или **F5**
   - Qt Creator автоматически:
     - Соберет APK (если нужно)
     - Установит приложение на телефон
     - Запустит приложение

3. **Проверьте на телефоне:**
   - Приложение должно автоматически запуститься
   - Проверьте все функции:
     - Загрузка файлов
     - Запись с микрофона
     - Воспроизведение сегментов
     - Склейка и реверс

### Вариант B: Создание APK и установка вручную

1. **Создайте APK:**
   - В Qt Creator: **Build → Build Android APK**
   - Или найдите APK в папке сборки:
     - `build/Android_Qt_5_15_2_Clang_Multi_Abi-Release/android-build/build/outputs/apk/debug/voice_upside_down-debug.apk`
     - или `build/android-build/voice_upside_down.apk`

2. **Установите APK:**
   ```bash
   adb install -r путь\к\voice_upside_down.apk
   ```
   Например:
   ```bash
   adb install -r "D:\git\New Year. Turn your voice upside down\New Year. Turn your voice upside down\voice_upside_down\build\Android_Qt_5_15_2_Clang_Multi_Abi-Release\android-build\build\outputs\apk\debug\voice_upside_down-debug.apk"
   ```

3. **Запустите на телефоне:**
   - Найдите приложение "Мастерская голоса" в списке приложений
   - Запустите его

## Шаг 4: Тестирование функций

### Проверьте следующие функции:

1. **Загрузка файла:**
   - Нажмите "Загрузить файл"
   - Выберите MP3 или WAV файл
   - Проверьте, что файл загрузился и появились сегменты

2. **Запись с микрофона:**
   - Нажмите "Включить микрофон"
   - Говорите в микрофон
   - Нажмите "Выключить микрофон"
   - Проверьте, что запись сохранилась

3. **Работа с сегментами:**
   - Прокрутите список сегментов
   - Нажмите "Воспроизвести оригинал" - должен играть звук
   - Нажмите "Реверс оригинал" - должен играть реверс
   - Нажмите "Записать" для записи сегмента
   - Нажмите "Воспроизвести запись" - должен играть записанный звук

4. **Склейка и реверс:**
   - Запишите несколько сегментов
   - Нажмите "Склеить отрезки"
   - Нажмите "Воспроизвести склейку"
   - Нажмите "Перевернуть песню"
   - Нажмите "Воспроизвести реверс"

5. **Сохранение/загрузка проекта:**
   - Нажмите "Сохранить проект"
   - Выберите папку для сохранения
   - Закройте приложение
   - Откройте приложение снова
   - Нажмите "Открыть проект"
   - Выберите сохраненный проект
   - Проверьте, что все данные восстановились

## Шаг 5: Просмотр логов

Если что-то не работает, проверьте логи:

### В Qt Creator:
- Откройте вкладку **Application Output** (внизу)
- Там будут все логи приложения

### Через ADB:
```bash
adb logcat | grep voice_upside_down
```

Или все логи:
```bash
adb logcat
```

## Решение проблем

### Проблема: Устройство не определяется
**Решение:**
- Проверьте USB кабель (используйте оригинальный)
- Убедитесь, что включена "Отладка по USB"
- Попробуйте другой USB порт
- Установите драйверы для вашего телефона

### Проблема: "Installation failed"
**Решение:**
- Убедитесь, что включена "Установка через USB" в настройках разработчика
- Проверьте, что на телефоне достаточно места
- Попробуйте удалить старое приложение (если было установлено)

### Проблема: Приложение не запускается
**Решение:**
- Проверьте логи через `adb logcat`
- Убедитесь, что все разрешения предоставлены (микрофон, хранилище)
- Проверьте, что APK собран для правильной архитектуры (arm64-v8a)

### Проблема: Нет звука
**Решение:**
- Проверьте громкость на телефоне
- Убедитесь, что предоставлено разрешение на запись аудио
- Проверьте, что файлы загружаются корректно

### Проблема: Интерфейс не помещается на экране
**Решение:**
- Проверьте, что используется `main_android.qml` (для Android)
- Убедитесь, что ориентация установлена в `portrait` в AndroidManifest.xml

## Отладка производительности

Для проверки производительности:
```bash
# Просмотр использования памяти
adb shell dumpsys meminfo com.voiceupsidedown.master

# Просмотр использования CPU
adb shell top | grep voice_upside_down
```

## Готово!

После успешного тестирования приложение готово к использованию на вашем Xiaomi K60 Ultra!

