cmake_minimum_required(VERSION 3.16)

project(voice_upside_down LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

if (NOT DEFINED CMAKE_BUILD_TYPE)
    set(CMAKE_BUILD_TYPE Release CACHE STRING "Choose the type of build." FORCE)
endif()

# Android configuration
if (ANDROID)
    set(ANDROID_PACKAGE_NAME "com.voiceupsidedown.master")
    set(ANDROID_APP_ICON "@mipmap/ic_launcher")
    set(ANDROID_MIN_SDK_VERSION 21)
    set(ANDROID_TARGET_SDK_VERSION 33)
endif()

set(CMAKE_AUTOMOC ON)
set(CMAKE_AUTORCC ON)
set(CMAKE_AUTOUIC ON)

# Try to find Qt6 first, then fall back to Qt5
find_package(Qt6 6.7.0 COMPONENTS
    Core
    Gui
    Quick
    Qml
    Multimedia
    QUIET
)

if(Qt6_FOUND)
    message(STATUS "Using Qt 6")
    set(QT_VERSION_MAJOR 6)
    set(QT_MIN_VERSION "6.7.0")
else()
    message(STATUS "Qt 6 not found, trying Qt 5")
    set(QT_MIN_VERSION "5.15.0")
    find_package(Qt5 ${QT_MIN_VERSION} COMPONENTS
        Widgets
        Quick
        Qml
        Multimedia
        REQUIRED
    )
    set(QT_VERSION_MAJOR 5)
    
    # QtGraphicalEffects is optional but recommended for visual effects
    find_package(Qt5 ${QT_MIN_VERSION} COMPONENTS QuickWidgets QUIET)
    if(Qt5QuickWidgets_FOUND)
        # QtGraphicalEffects is available through QuickWidgets
    endif()
endif()

add_subdirectory(src)

